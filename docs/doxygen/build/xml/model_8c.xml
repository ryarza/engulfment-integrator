<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.9.1" xml:lang="en-US">
  <compounddef id="model_8c" kind="file" language="C++">
    <compoundname>model.c</compoundname>
    <includes local="no">gsl/gsl_odeiv2.h</includes>
    <includes local="no">gsl/gsl_spline.h</includes>
    <includes local="no">gsl/gsl_matrix.h</includes>
    <includes local="no">gsl/gsl_errno.h</includes>
    <includes local="yes">hdf5.h</includes>
    <includes refid="model_8h" local="yes">model.h</includes>
    <includes refid="utils_8h" local="yes">utils.h</includes>
    <incdepgraph>
      <node id="11">
        <label>utils.h</label>
        <link refid="utils_8h"/>
      </node>
      <node id="8">
        <label>global.h</label>
        <link refid="global_8h"/>
        <childnode refid="9" relation="include">
        </childnode>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="10" relation="include">
        </childnode>
        <childnode refid="6" relation="include">
        </childnode>
      </node>
      <node id="6">
        <label>hdf5.h</label>
      </node>
      <node id="10">
        <label>math.h</label>
      </node>
      <node id="9">
        <label>gsl/gsl_math.h</label>
      </node>
      <node id="2">
        <label>gsl/gsl_odeiv2.h</label>
      </node>
      <node id="4">
        <label>gsl/gsl_matrix.h</label>
      </node>
      <node id="1">
        <label>model.c</label>
        <link refid="model_8c"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="6" relation="include">
        </childnode>
        <childnode refid="7" relation="include">
        </childnode>
        <childnode refid="11" relation="include">
        </childnode>
      </node>
      <node id="7">
        <label>model.h</label>
        <link refid="model_8h"/>
        <childnode refid="8" relation="include">
        </childnode>
      </node>
      <node id="3">
        <label>gsl/gsl_spline.h</label>
      </node>
      <node id="5">
        <label>gsl/gsl_errno.h</label>
      </node>
    </incdepgraph>
      <sectiondef kind="func">
      <memberdef kind="function" id="model_8c_1a90c59eea1bc597d21ec511441cc3c925" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int jac</definition>
        <argsstring>(double t, const double y[], double *dfdy, double dfdt[], void *params)</argsstring>
        <name>jac</name>
        <param>
          <type>double</type>
          <declname>t</declname>
        </param>
        <param>
          <type>const double</type>
          <declname>y</declname>
          <array>[]</array>
        </param>
        <param>
          <type>double *</type>
          <declname>dfdy</declname>
        </param>
        <param>
          <type>double</type>
          <declname>dfdt</declname>
          <array>[]</array>
        </param>
        <param>
          <type>void *</type>
          <declname>params</declname>
        </param>
        <briefdescription>
<para>Jacobian of the system of equations. Useful for ODE integrators that require it. Untested! </para>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/ryarza/Downloads/research/planets-ce/code/engulfment-integrator/src/model.c" line="26" column="5" bodyfile="/home/ryarza/Downloads/research/planets-ce/code/engulfment-integrator/src/model.c" bodystart="26" bodyend="102"/>
        <references refid="global_8h_1aedeba8fd92b0077b7c6724c0309ea62e" compoundref="star_8c" startline="23">acc_drhodr</references>
        <references refid="global_8h_1a7b76ae9f39a443e206a410c051e557fe" compoundref="star_8c" startline="25">acc_menc</references>
        <references refid="global_8h_1acf79bf70f986b203fe7fd8eb3e91a634" compoundref="star_8c" startline="21">acc_rho</references>
        <references refid="structrhs__terms_1a58e190d6c49e164fd7a2861bb2661586" compoundref="model_8h" startline="39">rhs_terms::G</references>
        <references refid="structrhs__terms_1a23f99710c6e1d093311561f0c6df46ae" compoundref="model_8h" startline="37">rhs_terms::Msb</references>
        <references refid="structrhs__terms_1a2da4d507d1c55b7c925c8440ad059d87" compoundref="model_8h" startline="35">rhs_terms::Rsb</references>
        <references refid="global_8h_1a4c4bdddddcd903509ed2ecf7c9cff218" compoundref="star_8c" startline="33">spline_drhodr</references>
        <references refid="global_8h_1abb8a871881d465e7625f07eddffa6785" compoundref="star_8c" startline="35">spline_menc</references>
        <references refid="global_8h_1a78d5a9eaea222c102b5f9ead2eba41ef" compoundref="star_8c" startline="31">spline_rho</references>
      </memberdef>
      <memberdef kind="function" id="model_8c_1a52123df6ff7716db1b9bc37a231b9705" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>double</type>
        <definition>double f_grav</definition>
        <argsstring>(struct rhs_terms *rhs, double rho, double v_theta, double q, double eps_rho, double rp_over_ra)</argsstring>
        <name>f_grav</name>
        <param>
          <type>struct <ref refid="structrhs__terms" kindref="compound">rhs_terms</ref> *</type>
          <declname>rhs</declname>
        </param>
        <param>
          <type>double</type>
          <declname>rho</declname>
        </param>
        <param>
          <type>double</type>
          <declname>v_theta</declname>
        </param>
        <param>
          <type>double</type>
          <declname>q</declname>
        </param>
        <param>
          <type>double</type>
          <declname>eps_rho</declname>
        </param>
        <param>
          <type>double</type>
          <declname>rp_over_ra</declname>
        </param>
        <briefdescription>
<para>Gravitational drag force. </para>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/ryarza/Downloads/research/planets-ce/code/engulfment-integrator/src/model.c" line="104" column="8" bodyfile="/home/ryarza/Downloads/research/planets-ce/code/engulfment-integrator/src/model.c" bodystart="104" bodyend="113"/>
        <references refid="structrhs__terms_1a63081a901688a91090165ce0f54aa353" compoundref="model_8h" startline="43">rhs_terms::cg_data</references>
        <references refid="structrhs__terms_1a303e005485ab20b9778d064fd43ded3f" compoundref="model_8h" startline="47">rhs_terms::drag_data_dims</references>
        <references refid="structrhs__terms_1a58e190d6c49e164fd7a2861bb2661586" compoundref="model_8h" startline="39">rhs_terms::G</references>
        <references refid="structrhs__terms_1a8ad51f73f9fc24cb4b878d4ac5361cc7" compoundref="model_8h" startline="51">rhs_terms::log_eps_rho_vals</references>
        <references refid="structrhs__terms_1a04fab25e61816a44ef263ff83e046519" compoundref="model_8h" startline="49">rhs_terms::log_q_vals</references>
        <references refid="structrhs__terms_1a77180908c43f26b69a47d40d2c081a92" compoundref="model_8h" startline="53">rhs_terms::log_rp_over_ra_vals</references>
        <references refid="structrhs__terms_1a23f99710c6e1d093311561f0c6df46ae" compoundref="model_8h" startline="37">rhs_terms::Msb</references>
        <references refid="utils_8c_1a8f3cba07aa75b7320ae8bd6c0aeac498" compoundref="utils_8c" startline="91" endline="98">sign</references>
        <references refid="utils_8c_1aca537472aac6353e383c279ab1cff9ff" compoundref="utils_8c" startline="51" endline="89">trilinear_interp</references>
        <references refid="structrhs__terms_1ac364a399b048a1b67d986844d0fc7c99" compoundref="model_8h" startline="41">rhs_terms::use_drag_coefficients</references>
        <referencedby refid="model_8c_1abca9d444b78fd82f9cfef8a367142d19" compoundref="model_8c" startline="140" endline="197">func</referencedby>
        <referencedby refid="io_8c_1af789b6233c9122901decdf3fe596d917" compoundref="io_8c" startline="173" endline="204">write_output</referencedby>
      </memberdef>
      <memberdef kind="function" id="model_8c_1af133e6d3b99c19b9b1ffba51e05adc50" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>double</type>
        <definition>double f_hydro</definition>
        <argsstring>(struct rhs_terms *rhs, double rho, double v_theta, double q, double eps_rho, double rp_over_ra)</argsstring>
        <name>f_hydro</name>
        <param>
          <type>struct <ref refid="structrhs__terms" kindref="compound">rhs_terms</ref> *</type>
          <declname>rhs</declname>
        </param>
        <param>
          <type>double</type>
          <declname>rho</declname>
        </param>
        <param>
          <type>double</type>
          <declname>v_theta</declname>
        </param>
        <param>
          <type>double</type>
          <declname>q</declname>
        </param>
        <param>
          <type>double</type>
          <declname>eps_rho</declname>
        </param>
        <param>
          <type>double</type>
          <declname>rp_over_ra</declname>
        </param>
        <briefdescription>
<para>Ram pressure drag force. </para>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/ryarza/Downloads/research/planets-ce/code/engulfment-integrator/src/model.c" line="115" column="8" bodyfile="/home/ryarza/Downloads/research/planets-ce/code/engulfment-integrator/src/model.c" bodystart="115" bodyend="124"/>
        <references refid="structrhs__terms_1aebefffdf507433a4e958bf302c49df65" compoundref="model_8h" startline="45">rhs_terms::cp_data</references>
        <references refid="structrhs__terms_1a303e005485ab20b9778d064fd43ded3f" compoundref="model_8h" startline="47">rhs_terms::drag_data_dims</references>
        <references refid="structrhs__terms_1a8ad51f73f9fc24cb4b878d4ac5361cc7" compoundref="model_8h" startline="51">rhs_terms::log_eps_rho_vals</references>
        <references refid="structrhs__terms_1a04fab25e61816a44ef263ff83e046519" compoundref="model_8h" startline="49">rhs_terms::log_q_vals</references>
        <references refid="structrhs__terms_1a77180908c43f26b69a47d40d2c081a92" compoundref="model_8h" startline="53">rhs_terms::log_rp_over_ra_vals</references>
        <references refid="structrhs__terms_1ab2616c315e3e04aeeb268ad0a5cd2723" compoundref="model_8h" startline="33">rhs_terms::sigma_hydro</references>
        <references refid="utils_8c_1a8f3cba07aa75b7320ae8bd6c0aeac498" compoundref="utils_8c" startline="91" endline="98">sign</references>
        <references refid="utils_8c_1aca537472aac6353e383c279ab1cff9ff" compoundref="utils_8c" startline="51" endline="89">trilinear_interp</references>
        <references refid="structrhs__terms_1ac364a399b048a1b67d986844d0fc7c99" compoundref="model_8h" startline="41">rhs_terms::use_drag_coefficients</references>
        <referencedby refid="model_8c_1abca9d444b78fd82f9cfef8a367142d19" compoundref="model_8c" startline="140" endline="197">func</referencedby>
        <referencedby refid="io_8c_1af789b6233c9122901decdf3fe596d917" compoundref="io_8c" startline="173" endline="204">write_output</referencedby>
      </memberdef>
      <memberdef kind="function" id="model_8c_1a7413b3adbedc8ce3474a78d49a6b9721" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int compute_flow_parameters</definition>
        <argsstring>(struct rhs_terms *rhs, const double *y, double menc, double hrho, double *q, double *eps_rho, double *rp_over_ra)</argsstring>
        <name>compute_flow_parameters</name>
        <param>
          <type>struct <ref refid="structrhs__terms" kindref="compound">rhs_terms</ref> *</type>
          <declname>rhs</declname>
        </param>
        <param>
          <type>const double *</type>
          <declname>y</declname>
        </param>
        <param>
          <type>double</type>
          <declname>menc</declname>
        </param>
        <param>
          <type>double</type>
          <declname>hrho</declname>
        </param>
        <param>
          <type>double *</type>
          <declname>q</declname>
        </param>
        <param>
          <type>double *</type>
          <declname>eps_rho</declname>
        </param>
        <param>
          <type>double *</type>
          <declname>rp_over_ra</declname>
        </param>
        <briefdescription>
<para>Relevant dimensionless flow parameters (mass ratio, density gradient, and ratio between geometrical and gravitational radii) </para>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/ryarza/Downloads/research/planets-ce/code/engulfment-integrator/src/model.c" line="126" column="5" bodyfile="/home/ryarza/Downloads/research/planets-ce/code/engulfment-integrator/src/model.c" bodystart="126" bodyend="138"/>
        <references refid="global_8h_1a8c5a521dd2cb882da9a99937f79f5837" compoundref="star_8c" startline="27">acc_cs</references>
        <references refid="structrhs__terms_1a58e190d6c49e164fd7a2861bb2661586" compoundref="model_8h" startline="39">rhs_terms::G</references>
        <references refid="structrhs__terms_1a23f99710c6e1d093311561f0c6df46ae" compoundref="model_8h" startline="37">rhs_terms::Msb</references>
        <references refid="structrhs__terms_1a2da4d507d1c55b7c925c8440ad059d87" compoundref="model_8h" startline="35">rhs_terms::Rsb</references>
        <references refid="global_8h_1adebc07be0db5cfee6bf35217cc1f8936" compoundref="star_8c" startline="37">spline_cs</references>
        <referencedby refid="model_8c_1abca9d444b78fd82f9cfef8a367142d19" compoundref="model_8c" startline="140" endline="197">func</referencedby>
        <referencedby refid="io_8c_1af789b6233c9122901decdf3fe596d917" compoundref="io_8c" startline="173" endline="204">write_output</referencedby>
      </memberdef>
      <memberdef kind="function" id="model_8c_1abca9d444b78fd82f9cfef8a367142d19" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int func</definition>
        <argsstring>(double t, const double y[], double f[], void *params)</argsstring>
        <name>func</name>
        <param>
          <type>double</type>
          <declname>t</declname>
        </param>
        <param>
          <type>const double</type>
          <declname>y</declname>
          <array>[]</array>
        </param>
        <param>
          <type>double</type>
          <declname>f</declname>
          <array>[]</array>
        </param>
        <param>
          <type>void *</type>
          <declname>params</declname>
        </param>
        <briefdescription>
<para>Evaluates the vector right-hand-side of the GSL ODE system. </para>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/ryarza/Downloads/research/planets-ce/code/engulfment-integrator/src/model.c" line="140" column="5" bodyfile="/home/ryarza/Downloads/research/planets-ce/code/engulfment-integrator/src/model.c" bodystart="140" bodyend="197"/>
        <references refid="global_8h_1a8c5a521dd2cb882da9a99937f79f5837" compoundref="star_8c" startline="27">acc_cs</references>
        <references refid="global_8h_1a4f47520db4595782a0ea2d8dbceb7f48" compoundref="star_8c" startline="29">acc_hrho</references>
        <references refid="global_8h_1a7b76ae9f39a443e206a410c051e557fe" compoundref="star_8c" startline="25">acc_menc</references>
        <references refid="global_8h_1acf79bf70f986b203fe7fd8eb3e91a634" compoundref="star_8c" startline="21">acc_rho</references>
        <references refid="model_8c_1a7413b3adbedc8ce3474a78d49a6b9721" compoundref="model_8c" startline="126" endline="138">compute_flow_parameters</references>
        <references refid="structrhs__terms_1a8e88fe897d46f15c82e2d9a35078d646" compoundref="model_8h" startline="31">rhs_terms::f_buoyancy</references>
        <references refid="model_8c_1a52123df6ff7716db1b9bc37a231b9705" compoundref="model_8c" startline="104" endline="113">f_grav</references>
        <references refid="structrhs__terms_1abe610e4b414ddeede219782c0248c991" compoundref="model_8h" startline="29">rhs_terms::f_grav</references>
        <references refid="model_8c_1af133e6d3b99c19b9b1ffba51e05adc50" compoundref="model_8c" startline="115" endline="124">f_hydro</references>
        <references refid="structrhs__terms_1ac13ca99dc6b23ea6aefc0b4d8c063341" compoundref="model_8h" startline="27">rhs_terms::f_hydro</references>
        <references refid="structrhs__terms_1a58e190d6c49e164fd7a2861bb2661586" compoundref="model_8h" startline="39">rhs_terms::G</references>
        <references refid="structrhs__terms_1a23f99710c6e1d093311561f0c6df46ae" compoundref="model_8h" startline="37">rhs_terms::Msb</references>
        <references refid="structrhs__terms_1a2da4d507d1c55b7c925c8440ad059d87" compoundref="model_8h" startline="35">rhs_terms::Rsb</references>
        <references refid="global_8h_1adebc07be0db5cfee6bf35217cc1f8936" compoundref="star_8c" startline="37">spline_cs</references>
        <references refid="global_8h_1ad9933c0d0863db02128a37ab15bccd56" compoundref="star_8c" startline="39">spline_hrho</references>
        <references refid="global_8h_1abb8a871881d465e7625f07eddffa6785" compoundref="star_8c" startline="35">spline_menc</references>
        <references refid="global_8h_1a78d5a9eaea222c102b5f9ead2eba41ef" compoundref="star_8c" startline="31">spline_rho</references>
        <referencedby refid="main_8c_1a0ddf1224851353fc92bfbff6f499fa97" compoundref="main_8c" startline="33" endline="126">main</referencedby>
      </memberdef>
      <memberdef kind="function" id="model_8c_1a5820dd0dc3a4b0513ac690f4408dc410" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int init_model_params</definition>
        <argsstring>(struct parameters P, struct star S, struct units U, struct rhs_terms *rhs)</argsstring>
        <name>init_model_params</name>
        <param>
          <type>struct <ref refid="structparameters" kindref="compound">parameters</ref></type>
          <declname>P</declname>
        </param>
        <param>
          <type>struct <ref refid="structstar" kindref="compound">star</ref></type>
          <declname>S</declname>
        </param>
        <param>
          <type>struct <ref refid="structunits" kindref="compound">units</ref></type>
          <declname>U</declname>
        </param>
        <param>
          <type>struct <ref refid="structrhs__terms" kindref="compound">rhs_terms</ref> *</type>
          <declname>rhs</declname>
        </param>
        <briefdescription>
<para>Initializes the right-hand-side parameter struct and copies the required parameters from other structs. Members of this struct are never modified and hold the value they had in the struct they were read from. </para>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/ryarza/Downloads/research/planets-ce/code/engulfment-integrator/src/model.c" line="199" column="5" bodyfile="/home/ryarza/Downloads/research/planets-ce/code/engulfment-integrator/src/model.c" bodystart="199" bodyend="317"/>
        <references refid="structrhs__terms_1a63081a901688a91090165ce0f54aa353" compoundref="model_8h" startline="43">rhs_terms::cg_data</references>
        <references refid="structrhs__terms_1aebefffdf507433a4e958bf302c49df65" compoundref="model_8h" startline="45">rhs_terms::cp_data</references>
        <references refid="structrhs__terms_1a303e005485ab20b9778d064fd43ded3f" compoundref="model_8h" startline="47">rhs_terms::drag_data_dims</references>
        <references refid="structparameters_1a222e7500d94731b8efdae777c71ca8d9" compoundref="global_8h" startline="63">parameters::drag_data_path</references>
        <references refid="structparameters_1a65676f4e46da862a87074caa262f7352" compoundref="global_8h" startline="46">parameters::f_buoyancy</references>
        <references refid="structrhs__terms_1a8e88fe897d46f15c82e2d9a35078d646" compoundref="model_8h" startline="31">rhs_terms::f_buoyancy</references>
        <references refid="structparameters_1a44b8f833c7ff07dc990a137b49d306f3" compoundref="global_8h" startline="44">parameters::f_grav</references>
        <references refid="structrhs__terms_1abe610e4b414ddeede219782c0248c991" compoundref="model_8h" startline="29">rhs_terms::f_grav</references>
        <references refid="structparameters_1a6960e6f48d147c12441609628d186b35" compoundref="global_8h" startline="42">parameters::f_hydro</references>
        <references refid="structrhs__terms_1ac13ca99dc6b23ea6aefc0b4d8c063341" compoundref="model_8h" startline="27">rhs_terms::f_hydro</references>
        <references refid="structunits_1ab46825a17a984286d00a3a09bdf28571" compoundref="global_8h" startline="89">units::G</references>
        <references refid="structrhs__terms_1a58e190d6c49e164fd7a2861bb2661586" compoundref="model_8h" startline="39">rhs_terms::G</references>
        <references refid="global_8h_1ad2753c8a41f8a7a0f8b707fe3316f2dd" compoundref="io_8c" startline="206" endline="208">h5safecall</references>
        <references refid="structrhs__terms_1a8ad51f73f9fc24cb4b878d4ac5361cc7" compoundref="model_8h" startline="51">rhs_terms::log_eps_rho_vals</references>
        <references refid="structrhs__terms_1a04fab25e61816a44ef263ff83e046519" compoundref="model_8h" startline="49">rhs_terms::log_q_vals</references>
        <references refid="structrhs__terms_1a77180908c43f26b69a47d40d2c081a92" compoundref="model_8h" startline="53">rhs_terms::log_rp_over_ra_vals</references>
        <references refid="structparameters_1ab5115d22be6204fdc5bbf6445269efa0" compoundref="global_8h" startline="48">parameters::Msb</references>
        <references refid="structrhs__terms_1a23f99710c6e1d093311561f0c6df46ae" compoundref="model_8h" startline="37">rhs_terms::Msb</references>
        <references refid="structparameters_1a44dd01bc440a7226465b0e38310929b1" compoundref="global_8h" startline="50">parameters::Rsb</references>
        <references refid="structrhs__terms_1a2da4d507d1c55b7c925c8440ad059d87" compoundref="model_8h" startline="35">rhs_terms::Rsb</references>
        <references refid="structrhs__terms_1ab2616c315e3e04aeeb268ad0a5cd2723" compoundref="model_8h" startline="33">rhs_terms::sigma_hydro</references>
        <references refid="structparameters_1ab8ff76e9250a51d11724566a9fe840ca" compoundref="global_8h" startline="61">parameters::use_drag_coefficients</references>
        <references refid="structrhs__terms_1ac364a399b048a1b67d986844d0fc7c99" compoundref="model_8h" startline="41">rhs_terms::use_drag_coefficients</references>
        <referencedby refid="main_8c_1a0ddf1224851353fc92bfbff6f499fa97" compoundref="main_8c" startline="33" endline="126">main</referencedby>
      </memberdef>
      </sectiondef>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="comment">//<sp/>Copyright<sp/>2021<sp/>Ricardo<sp/>Yarza.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2"><highlight class="normal"></highlight><highlight class="comment">//</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3"><highlight class="normal"></highlight><highlight class="comment">//<sp/>This<sp/>file<sp/>is<sp/>part<sp/>of<sp/>orbit-integrator</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4"><highlight class="normal"></highlight><highlight class="comment">//</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5"><highlight class="normal"></highlight><highlight class="comment">//<sp/>orbit-integrator<sp/>is<sp/>free<sp/>software:<sp/>you<sp/>can<sp/>redistribute<sp/>it<sp/>and/or<sp/>modify</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6"><highlight class="normal"></highlight><highlight class="comment">//<sp/>it<sp/>under<sp/>the<sp/>terms<sp/>of<sp/>the<sp/>GNU<sp/>General<sp/>Public<sp/>License<sp/>as<sp/>published<sp/>by</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7"><highlight class="normal"></highlight><highlight class="comment">//<sp/>the<sp/>Free<sp/>Software<sp/>Foundation,<sp/>either<sp/>version<sp/>3<sp/>of<sp/>the<sp/>License,<sp/>or</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8"><highlight class="normal"></highlight><highlight class="comment">//<sp/>(at<sp/>your<sp/>option)<sp/>any<sp/>later<sp/>version.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="9"><highlight class="normal"></highlight><highlight class="comment">//</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="10"><highlight class="normal"></highlight><highlight class="comment">//<sp/>orbit-integrator<sp/>is<sp/>distributed<sp/>in<sp/>the<sp/>hope<sp/>that<sp/>it<sp/>will<sp/>be<sp/>useful,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="11"><highlight class="normal"></highlight><highlight class="comment">//<sp/>but<sp/>WITHOUT<sp/>ANY<sp/>WARRANTY;<sp/>without<sp/>even<sp/>the<sp/>implied<sp/>warranty<sp/>of</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="12"><highlight class="normal"></highlight><highlight class="comment">//<sp/>MERCHANTABILITY<sp/>or<sp/>FITNESS<sp/>FOR<sp/>A<sp/>PARTICULAR<sp/>PURPOSE.<sp/><sp/>See<sp/>the</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="13"><highlight class="normal"></highlight><highlight class="comment">//<sp/>GNU<sp/>General<sp/>Public<sp/>License<sp/>for<sp/>more<sp/>details.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="14"><highlight class="normal"></highlight><highlight class="comment">//</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="15"><highlight class="normal"></highlight><highlight class="comment">//<sp/>You<sp/>should<sp/>have<sp/>received<sp/>a<sp/>copy<sp/>of<sp/>the<sp/>GNU<sp/>General<sp/>Public<sp/>License</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="16"><highlight class="normal"></highlight><highlight class="comment">//<sp/>along<sp/>with<sp/>orbit-integrator.<sp/><sp/>If<sp/>not,<sp/>see<sp/>&lt;https://www.gnu.org/licenses/&gt;.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="17"><highlight class="normal"></highlight></codeline>
<codeline lineno="18"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;gsl/gsl_odeiv2.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="19"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;gsl/gsl_spline.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="20"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;gsl/gsl_matrix.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="21"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;gsl/gsl_errno.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="22"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;hdf5.h&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="23"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="model_8h" kindref="compound">model.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="24"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="utils_8h" kindref="compound">utils.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="25"><highlight class="normal"></highlight></codeline>
<codeline lineno="26" refid="model_8c_1a90c59eea1bc597d21ec511441cc3c925" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="model_8c_1a90c59eea1bc597d21ec511441cc3c925" kindref="member">jac</ref><sp/>(</highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>t,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>y[],<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>*dfdy,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>dfdt[],<sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*params)</highlight></codeline>
<codeline lineno="27"><highlight class="normal">{</highlight></codeline>
<codeline lineno="28"><highlight class="normal"><sp/><sp/>(void)(t);<sp/></highlight><highlight class="comment">/*<sp/>avoid<sp/>unused<sp/>parameter<sp/>warning<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="29"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structrhs__terms" kindref="compound">rhs_terms</ref><sp/>*<sp/>rhs<sp/>=<sp/>(</highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structrhs__terms" kindref="compound">rhs_terms</ref><sp/>*)params;</highlight></codeline>
<codeline lineno="30"><highlight class="normal"></highlight></codeline>
<codeline lineno="31"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>menc,<sp/>rho,<sp/>drhodr;</highlight></codeline>
<codeline lineno="32"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>status1<sp/>=<sp/>gsl_spline_eval_e(<ref refid="global_8h_1abb8a871881d465e7625f07eddffa6785" kindref="member">spline_menc</ref>,<sp/>y[0],<sp/><ref refid="global_8h_1a7b76ae9f39a443e206a410c051e557fe" kindref="member">acc_menc</ref>,<sp/>&amp;menc);</highlight></codeline>
<codeline lineno="33"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>status2<sp/>=<sp/>gsl_spline_eval_e(<ref refid="global_8h_1a78d5a9eaea222c102b5f9ead2eba41ef" kindref="member">spline_rho</ref>,<sp/>y[0],<sp/><ref refid="global_8h_1acf79bf70f986b203fe7fd8eb3e91a634" kindref="member">acc_rho</ref>,<sp/>&amp;rho);</highlight></codeline>
<codeline lineno="34"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>status3<sp/>=<sp/>gsl_spline_eval_e(<ref refid="global_8h_1a4c4bdddddcd903509ed2ecf7c9cff218" kindref="member">spline_drhodr</ref>,<sp/>y[0],<sp/><ref refid="global_8h_1aedeba8fd92b0077b7c6724c0309ea62e" kindref="member">acc_drhodr</ref>,<sp/>&amp;drhodr);</highlight></codeline>
<codeline lineno="35"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>(<sp/>status1<sp/>!=<sp/>GSL_SUCCESS<sp/>)<sp/>||<sp/>(<sp/>status2<sp/>!=<sp/>GSL_SUCCESS<sp/>)<sp/>||<sp/>(<sp/>status3<sp/>!=<sp/>GSL_SUCCESS<sp/>)<sp/>){</highlight></codeline>
<codeline lineno="36"><highlight class="normal"><sp/><sp/><sp/><sp/>printf(</highlight><highlight class="stringliteral">&quot;Interpolation<sp/>failed<sp/>at<sp/>radius<sp/>%.10e.<sp/>Exit<sp/>codes<sp/>for<sp/>menc,<sp/>rho,<sp/>drhodr:<sp/>%i<sp/>%i<sp/>%i\n&quot;</highlight><highlight class="normal">,<sp/>y[0],<sp/>status1,<sp/>status2,<sp/>status3);</highlight></codeline>
<codeline lineno="37"><highlight class="normal"><sp/><sp/><sp/><sp/>exit(-1);</highlight></codeline>
<codeline lineno="38"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="39"><highlight class="normal"></highlight></codeline>
<codeline lineno="40"><highlight class="normal"><sp/><sp/>gsl_matrix_view<sp/>dfdy_mat<sp/>=<sp/>gsl_matrix_view_array<sp/>(dfdy,<sp/>4,<sp/>4);</highlight></codeline>
<codeline lineno="41"><highlight class="normal"><sp/><sp/>gsl_matrix<sp/>*<sp/>m<sp/>=<sp/>&amp;dfdy_mat.matrix;</highlight></codeline>
<codeline lineno="42"><highlight class="normal"></highlight></codeline>
<codeline lineno="43"><highlight class="normal"><sp/><sp/>gsl_matrix_set<sp/>(m,<sp/>0,<sp/>0,<sp/>0.);</highlight></codeline>
<codeline lineno="44"><highlight class="normal"><sp/><sp/>gsl_matrix_set<sp/>(m,<sp/>0,<sp/>1,<sp/>0.);</highlight></codeline>
<codeline lineno="45"><highlight class="normal"><sp/><sp/>gsl_matrix_set<sp/>(m,<sp/>0,<sp/>2,<sp/>1.);</highlight></codeline>
<codeline lineno="46"><highlight class="normal"><sp/><sp/>gsl_matrix_set<sp/>(m,<sp/>0,<sp/>3,<sp/>0.);</highlight></codeline>
<codeline lineno="47"><highlight class="normal"></highlight></codeline>
<codeline lineno="48"><highlight class="normal"><sp/><sp/>gsl_matrix_set<sp/>(m,<sp/>1,<sp/>0,<sp/>0.);</highlight></codeline>
<codeline lineno="49"><highlight class="normal"><sp/><sp/>gsl_matrix_set<sp/>(m,<sp/>1,<sp/>1,<sp/>0.);</highlight></codeline>
<codeline lineno="50"><highlight class="normal"><sp/><sp/>gsl_matrix_set<sp/>(m,<sp/>1,<sp/>2,<sp/>0.);</highlight></codeline>
<codeline lineno="51"><highlight class="normal"><sp/><sp/>gsl_matrix_set<sp/>(m,<sp/>1,<sp/>3,<sp/>1.);</highlight></codeline>
<codeline lineno="52"><highlight class="normal"></highlight></codeline>
<codeline lineno="53"><highlight class="normal"><sp/><sp/>gsl_matrix_set<sp/>(m,<sp/>2,<sp/>0,<sp/>2<sp/>*<sp/>rhs-&gt;<ref refid="structrhs__terms_1a58e190d6c49e164fd7a2861bb2661586" kindref="member">G</ref><sp/>*<sp/>menc<sp/>/<sp/>pow(y[0],<sp/>3.)<sp/>-<sp/>4.<sp/>*<sp/>rhs-&gt;<ref refid="structrhs__terms_1a58e190d6c49e164fd7a2861bb2661586" kindref="member">G</ref><sp/>*<sp/>M_PI<sp/>*<sp/>rho<sp/>+<sp/>pow(y[3],<sp/>2.));</highlight></codeline>
<codeline lineno="54"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/>gsl_matrix_set<sp/>(m,<sp/>2,<sp/>0,<sp/>2<sp/>*<sp/>rhs-&gt;G<sp/>*<sp/>menc<sp/>/<sp/>pow(y[0],<sp/>3.)<sp/>+<sp/>pow(y[3],<sp/>2.));</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="55"><highlight class="normal"><sp/><sp/>gsl_matrix_set<sp/>(m,<sp/>2,<sp/>1,<sp/>0.);</highlight></codeline>
<codeline lineno="56"><highlight class="normal"><sp/><sp/>gsl_matrix_set<sp/>(m,<sp/>2,<sp/>2,<sp/>0.);</highlight></codeline>
<codeline lineno="57"><highlight class="normal"><sp/><sp/>gsl_matrix_set<sp/>(m,<sp/>2,<sp/>3,<sp/>2<sp/>*<sp/>y[0]<sp/>*<sp/>y[3]);</highlight></codeline>
<codeline lineno="58"><highlight class="normal"></highlight></codeline>
<codeline lineno="59"><highlight class="normal"></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="60"><highlight class="comment"><sp/><sp/>Old<sp/>terms</highlight></codeline>
<codeline lineno="61"><highlight class="comment"><sp/><sp/>double<sp/>term1<sp/>=<sp/>32.<sp/>*<sp/>pow(rhs-&gt;G,<sp/>2.)<sp/>*<sp/>pow(M_PI,<sp/>2.)<sp/>*<sp/>menc<sp/>*<sp/>pow(y[0],<sp/>3.)<sp/>*<sp/>pow(rho,<sp/>2.);</highlight></codeline>
<codeline lineno="62"><highlight class="comment"><sp/><sp/>double<sp/>term2<sp/>=<sp/>4.<sp/>*<sp/>pow(rhs-&gt;G,<sp/>2.)<sp/>*<sp/>M_PI<sp/>*<sp/>pow(menc,<sp/>2.)<sp/>*<sp/>(<sp/>-<sp/>3.<sp/>*<sp/>rho<sp/>+<sp/>y[0]<sp/>*<sp/>drhodr<sp/>);</highlight></codeline>
<codeline lineno="63"><highlight class="comment"><sp/><sp/>double<sp/>term3<sp/>=<sp/>pow(y[0],<sp/>2.)<sp/>*<sp/>pow(y[3],<sp/>3.)<sp/>*<sp/>(<sp/>2<sp/>*<sp/>rhs-&gt;Msb<sp/>*<sp/>y[2]<sp/>+<sp/>M_PI<sp/>*<sp/>pow(rhs-&gt;Rsb,<sp/>2.)<sp/>*<sp/>pow(y[0],<sp/>2.)<sp/>*<sp/>y[3]<sp/>*<sp/>(<sp/>rho<sp/>+<sp/>y[0]<sp/>*<sp/>drhodr<sp/>)<sp/>);</highlight></codeline>
<codeline lineno="64"><highlight class="comment"><sp/><sp/>double<sp/>num<sp/>=<sp/>term1<sp/>+<sp/>term2<sp/>+<sp/>term3;</highlight></codeline>
<codeline lineno="65"><highlight class="comment"><sp/><sp/>double<sp/>den<sp/>=<sp/>rhs-&gt;Msb<sp/>*<sp/>pow(y[0],<sp/>4.)<sp/>*<sp/>pow(y[3],<sp/>2.);</highlight></codeline>
<codeline lineno="66"><highlight class="comment"><sp/><sp/>double<sp/>j30<sp/>=<sp/>num/den;</highlight></codeline>
<codeline lineno="67"><highlight class="comment">*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="68"><highlight class="normal"></highlight></codeline>
<codeline lineno="69"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>New<sp/>(hopefully<sp/>still<sp/>correct)<sp/>terms<sp/>that<sp/>are<sp/>more<sp/>numerically<sp/>stable</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="70"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>term1<sp/>=<sp/>-<sp/>12.<sp/>*<sp/>pow(rhs-&gt;<ref refid="structrhs__terms_1a58e190d6c49e164fd7a2861bb2661586" kindref="member">G</ref>,<sp/>2.)<sp/>*<sp/>M_PI<sp/>*<sp/>pow(menc,<sp/>2)<sp/>*<sp/>rho<sp/>/<sp/>(<sp/>rhs-&gt;<ref refid="structrhs__terms_1a23f99710c6e1d093311561f0c6df46ae" kindref="member">Msb</ref><sp/>*<sp/>pow(y[0],<sp/>4.)<sp/>*<sp/>pow(y[3],<sp/>2.)<sp/>);</highlight></codeline>
<codeline lineno="71"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>term2<sp/>=<sp/>32.<sp/>*<sp/>pow(rhs-&gt;<ref refid="structrhs__terms_1a58e190d6c49e164fd7a2861bb2661586" kindref="member">G</ref><sp/>*<sp/>M_PI<sp/>*<sp/>rho,<sp/>2.)<sp/>*<sp/>menc<sp/>/<sp/>(<sp/>rhs-&gt;<ref refid="structrhs__terms_1a23f99710c6e1d093311561f0c6df46ae" kindref="member">Msb</ref><sp/>*<sp/>y[0]<sp/>*<sp/>pow(y[3],<sp/>2.)<sp/>);</highlight></codeline>
<codeline lineno="72"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>term3<sp/>=<sp/>2.<sp/>*<sp/>y[2]<sp/>*<sp/>y[3]<sp/>/<sp/>pow(y[0],<sp/>2.);</highlight></codeline>
<codeline lineno="73"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>term4<sp/>=<sp/>M_PI<sp/>*<sp/>pow(rhs-&gt;<ref refid="structrhs__terms_1a2da4d507d1c55b7c925c8440ad059d87" kindref="member">Rsb</ref><sp/>*<sp/>y[3],<sp/>2.)<sp/>*<sp/>rho<sp/>/<sp/>rhs-&gt;<ref refid="structrhs__terms_1a23f99710c6e1d093311561f0c6df46ae" kindref="member">Msb</ref>;</highlight></codeline>
<codeline lineno="74"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>term5<sp/>=<sp/>4.<sp/>*<sp/>M_PI<sp/>*<sp/>pow(rhs-&gt;<ref refid="structrhs__terms_1a58e190d6c49e164fd7a2861bb2661586" kindref="member">G</ref><sp/>*<sp/>menc,<sp/>2.)<sp/>*<sp/>drhodr<sp/>/<sp/>(<sp/>rhs-&gt;<ref refid="structrhs__terms_1a23f99710c6e1d093311561f0c6df46ae" kindref="member">Msb</ref><sp/>*<sp/>pow(y[0],<sp/>3.)<sp/>*<sp/>pow(y[3],<sp/>2.)<sp/>);</highlight></codeline>
<codeline lineno="75"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>term6<sp/>=<sp/>M_PI<sp/>*<sp/>pow(rhs-&gt;<ref refid="structrhs__terms_1a2da4d507d1c55b7c925c8440ad059d87" kindref="member">Rsb</ref><sp/>*<sp/>y[3],<sp/>2.)<sp/>*<sp/>y[0]<sp/>*<sp/>drhodr<sp/>/<sp/>rhs-&gt;<ref refid="structrhs__terms_1a23f99710c6e1d093311561f0c6df46ae" kindref="member">Msb</ref>;</highlight></codeline>
<codeline lineno="76"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>j30<sp/>=<sp/>term1<sp/>+<sp/>term2<sp/>+<sp/>term3<sp/>+<sp/>term4<sp/>+<sp/>term5<sp/>+<sp/>term6;</highlight></codeline>
<codeline lineno="77"><highlight class="normal"></highlight></codeline>
<codeline lineno="78"><highlight class="normal"><sp/><sp/>gsl_matrix_set<sp/>(m,<sp/>3,<sp/>0,<sp/>j30);</highlight></codeline>
<codeline lineno="79"><highlight class="normal"></highlight></codeline>
<codeline lineno="80"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Just<sp/>Keplerian<sp/>term</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="81"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/>gsl_matrix_set<sp/>(m,<sp/>3,<sp/>0,<sp/>2<sp/>*<sp/>y[2]<sp/>*<sp/>y[3]<sp/>/<sp/>pow(y[0],<sp/>2));</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="82"><highlight class="normal"><sp/><sp/>gsl_matrix_set<sp/>(m,<sp/>3,<sp/>1,<sp/>0.);</highlight></codeline>
<codeline lineno="83"><highlight class="normal"><sp/><sp/>gsl_matrix_set<sp/>(m,<sp/>3,<sp/>2,<sp/>-<sp/>2.<sp/>*<sp/>y[3]<sp/>/<sp/>y[0]);</highlight></codeline>
<codeline lineno="84"><highlight class="normal"></highlight></codeline>
<codeline lineno="85"><highlight class="normal"><sp/><sp/>term1<sp/>=<sp/>-2.<sp/>*<sp/>y[2]<sp/>/<sp/>y[0];</highlight></codeline>
<codeline lineno="86"><highlight class="normal"><sp/><sp/>term2<sp/>=<sp/>-<sp/>8.<sp/>*<sp/>pow(rhs-&gt;<ref refid="structrhs__terms_1a58e190d6c49e164fd7a2861bb2661586" kindref="member">G</ref>,<sp/>2.)<sp/>*<sp/>M_PI<sp/>*<sp/>pow(menc,<sp/>2.)<sp/>*<sp/>rho<sp/>/<sp/>(<sp/>rhs-&gt;<ref refid="structrhs__terms_1a23f99710c6e1d093311561f0c6df46ae" kindref="member">Msb</ref><sp/>*<sp/>pow(y[0],<sp/>3.)<sp/>*<sp/>pow(y[3],<sp/>3.)<sp/>);</highlight></codeline>
<codeline lineno="87"><highlight class="normal"><sp/><sp/>term3<sp/>=<sp/>2.<sp/>*<sp/>M_PI<sp/>*<sp/>pow(rhs-&gt;<ref refid="structrhs__terms_1a2da4d507d1c55b7c925c8440ad059d87" kindref="member">Rsb</ref>,<sp/>2.)<sp/>*<sp/>y[0]<sp/>*<sp/>rho<sp/>*<sp/>y[3]<sp/>/<sp/>rhs-&gt;<ref refid="structrhs__terms_1a23f99710c6e1d093311561f0c6df46ae" kindref="member">Msb</ref>;</highlight></codeline>
<codeline lineno="88"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>j33<sp/>=<sp/>term1<sp/>+<sp/>term2<sp/>+<sp/>term3;</highlight></codeline>
<codeline lineno="89"><highlight class="normal"><sp/><sp/>gsl_matrix_set<sp/>(m,<sp/>3,<sp/>3,<sp/>j33);</highlight></codeline>
<codeline lineno="90"><highlight class="normal"></highlight></codeline>
<codeline lineno="91"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Just<sp/>Keplerian<sp/>term</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="92"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/>gsl_matrix_set<sp/>(m,<sp/>3,<sp/>3,<sp/>-2.<sp/>*<sp/>y[2]<sp/>/<sp/>y[0]);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="93"><highlight class="normal"></highlight></codeline>
<codeline lineno="94"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>No<sp/>explicit<sp/>time<sp/>dependence</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="95"><highlight class="normal"><sp/><sp/>dfdt[0]<sp/>=<sp/>0.0;</highlight></codeline>
<codeline lineno="96"><highlight class="normal"><sp/><sp/>dfdt[1]<sp/>=<sp/>0.0;</highlight></codeline>
<codeline lineno="97"><highlight class="normal"><sp/><sp/>dfdt[2]<sp/>=<sp/>0.0;</highlight></codeline>
<codeline lineno="98"><highlight class="normal"><sp/><sp/>dfdt[3]<sp/>=<sp/>0.0;</highlight></codeline>
<codeline lineno="99"><highlight class="normal"></highlight></codeline>
<codeline lineno="100"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>GSL_SUCCESS;</highlight></codeline>
<codeline lineno="101"><highlight class="normal"></highlight></codeline>
<codeline lineno="102"><highlight class="normal">}</highlight></codeline>
<codeline lineno="103"><highlight class="normal"></highlight></codeline>
<codeline lineno="104" refid="model_8c_1a52123df6ff7716db1b9bc37a231b9705" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="model_8c_1a52123df6ff7716db1b9bc37a231b9705" kindref="member">f_grav</ref>(</highlight><highlight class="keyword">struct</highlight><highlight class="normal"><sp/><ref refid="structrhs__terms" kindref="compound">rhs_terms</ref><sp/>*rhs,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>rho,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>v_theta,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>q,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>eps_rho,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>rp_over_ra){</highlight></codeline>
<codeline lineno="105"><highlight class="normal"></highlight></codeline>
<codeline lineno="106"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>cg<sp/>=<sp/>1.;</highlight></codeline>
<codeline lineno="107"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>rhs-&gt;<ref refid="structrhs__terms_1ac364a399b048a1b67d986844d0fc7c99" kindref="member">use_drag_coefficients</ref><sp/>==<sp/>1<sp/>){</highlight></codeline>
<codeline lineno="108"><highlight class="normal"><sp/><sp/><sp/><sp/>cg<sp/>=<sp/><ref refid="utils_8c_1aca537472aac6353e383c279ab1cff9ff" kindref="member">trilinear_interp</ref>(rhs-&gt;<ref refid="structrhs__terms_1a63081a901688a91090165ce0f54aa353" kindref="member">cg_data</ref>,<sp/>rhs-&gt;<ref refid="structrhs__terms_1a04fab25e61816a44ef263ff83e046519" kindref="member">log_q_vals</ref>,<sp/>rhs-&gt;<ref refid="structrhs__terms_1a8ad51f73f9fc24cb4b878d4ac5361cc7" kindref="member">log_eps_rho_vals</ref>,<sp/>rhs-&gt;<ref refid="structrhs__terms_1a77180908c43f26b69a47d40d2c081a92" kindref="member">log_rp_over_ra_vals</ref>,<sp/>rhs-&gt;<ref refid="structrhs__terms_1a303e005485ab20b9778d064fd43ded3f" kindref="member">drag_data_dims</ref>,<sp/>log10(q),<sp/>log10(eps_rho),<sp/>log10(rp_over_ra));</highlight></codeline>
<codeline lineno="109"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="110"><highlight class="normal"></highlight></codeline>
<codeline lineno="111"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-<sp/>4.<sp/>*<sp/>M_PI<sp/>*<sp/>pow(rhs-&gt;<ref refid="structrhs__terms_1a58e190d6c49e164fd7a2861bb2661586" kindref="member">G</ref>,<sp/>2.)<sp/>*<sp/><ref refid="utils_8c_1a8f3cba07aa75b7320ae8bd6c0aeac498" kindref="member">sign</ref>(v_theta)<sp/>*<sp/>cg<sp/>*<sp/>rho<sp/>*<sp/>pow(rhs-&gt;<ref refid="structrhs__terms_1a23f99710c6e1d093311561f0c6df46ae" kindref="member">Msb</ref>,<sp/>2.)<sp/>/<sp/>fabs(v_theta<sp/>*<sp/>v_theta);</highlight></codeline>
<codeline lineno="112"><highlight class="normal"></highlight></codeline>
<codeline lineno="113"><highlight class="normal">}</highlight></codeline>
<codeline lineno="114"><highlight class="normal"></highlight></codeline>
<codeline lineno="115" refid="model_8c_1af133e6d3b99c19b9b1ffba51e05adc50" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="model_8c_1af133e6d3b99c19b9b1ffba51e05adc50" kindref="member">f_hydro</ref>(</highlight><highlight class="keyword">struct</highlight><highlight class="normal"><sp/><ref refid="structrhs__terms" kindref="compound">rhs_terms</ref><sp/>*rhs,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>rho,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>v_theta,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>q,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>eps_rho,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>rp_over_ra){</highlight></codeline>
<codeline lineno="116"><highlight class="normal"></highlight></codeline>
<codeline lineno="117"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>cp<sp/>=<sp/>0.25;</highlight></codeline>
<codeline lineno="118"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>rhs-&gt;<ref refid="structrhs__terms_1ac364a399b048a1b67d986844d0fc7c99" kindref="member">use_drag_coefficients</ref><sp/>==<sp/>1){</highlight></codeline>
<codeline lineno="119"><highlight class="normal"><sp/><sp/><sp/><sp/>cp<sp/>=<sp/><ref refid="utils_8c_1aca537472aac6353e383c279ab1cff9ff" kindref="member">trilinear_interp</ref>(rhs-&gt;<ref refid="structrhs__terms_1aebefffdf507433a4e958bf302c49df65" kindref="member">cp_data</ref>,<sp/>rhs-&gt;<ref refid="structrhs__terms_1a04fab25e61816a44ef263ff83e046519" kindref="member">log_q_vals</ref>,<sp/>rhs-&gt;<ref refid="structrhs__terms_1a8ad51f73f9fc24cb4b878d4ac5361cc7" kindref="member">log_eps_rho_vals</ref>,<sp/>rhs-&gt;<ref refid="structrhs__terms_1a77180908c43f26b69a47d40d2c081a92" kindref="member">log_rp_over_ra_vals</ref>,<sp/>rhs-&gt;<ref refid="structrhs__terms_1a303e005485ab20b9778d064fd43ded3f" kindref="member">drag_data_dims</ref>,<sp/>log10(q),<sp/>log10(eps_rho),<sp/>log10(rp_over_ra));</highlight></codeline>
<codeline lineno="120"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="121"><highlight class="normal"></highlight></codeline>
<codeline lineno="122"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-<sp/><ref refid="utils_8c_1a8f3cba07aa75b7320ae8bd6c0aeac498" kindref="member">sign</ref>(v_theta)<sp/>*<sp/>cp<sp/>*<sp/>rho<sp/>*<sp/>v_theta<sp/>*<sp/>v_theta<sp/>*<sp/>rhs-&gt;<ref refid="structrhs__terms_1ab2616c315e3e04aeeb268ad0a5cd2723" kindref="member">sigma_hydro</ref>;</highlight></codeline>
<codeline lineno="123"><highlight class="normal"></highlight></codeline>
<codeline lineno="124"><highlight class="normal">}</highlight></codeline>
<codeline lineno="125"><highlight class="normal"></highlight></codeline>
<codeline lineno="126" refid="model_8c_1a7413b3adbedc8ce3474a78d49a6b9721" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="model_8c_1a7413b3adbedc8ce3474a78d49a6b9721" kindref="member">compute_flow_parameters</ref>(</highlight><highlight class="keyword">struct</highlight><highlight class="normal"><sp/><ref refid="structrhs__terms" kindref="compound">rhs_terms</ref><sp/>*rhs,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>*y,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>menc,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>hrho,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>*q,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>*eps_rho,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>*rp_over_ra)</highlight></codeline>
<codeline lineno="127"><highlight class="normal">{</highlight></codeline>
<codeline lineno="128"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>cs;</highlight></codeline>
<codeline lineno="129"><highlight class="normal"><sp/><sp/>gsl_spline_eval_e(<ref refid="global_8h_1adebc07be0db5cfee6bf35217cc1f8936" kindref="member">spline_cs</ref>,<sp/>y[0],<sp/><ref refid="global_8h_1a8c5a521dd2cb882da9a99937f79f5837" kindref="member">acc_cs</ref>,<sp/>&amp;cs);</highlight></codeline>
<codeline lineno="130"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>v_theta<sp/>=<sp/>y[0]<sp/>*<sp/>y[3];</highlight></codeline>
<codeline lineno="131"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/>double<sp/>ra<sp/>=<sp/>2.<sp/>*<sp/>rhs-&gt;G<sp/>*<sp/>rhs-&gt;Msb<sp/>/<sp/>(<sp/>pow(v_theta,<sp/>2.)<sp/>+<sp/>pow(cs,<sp/>2.)<sp/>);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="132"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>ra<sp/>=<sp/>2.<sp/>*<sp/>rhs-&gt;<ref refid="structrhs__terms_1a58e190d6c49e164fd7a2861bb2661586" kindref="member">G</ref><sp/>*<sp/>rhs-&gt;<ref refid="structrhs__terms_1a23f99710c6e1d093311561f0c6df46ae" kindref="member">Msb</ref><sp/>/<sp/>(<sp/>pow(v_theta,<sp/>2.)<sp/>);</highlight></codeline>
<codeline lineno="133"><highlight class="normal"><sp/><sp/>*q<sp/>=<sp/>rhs-&gt;<ref refid="structrhs__terms_1a23f99710c6e1d093311561f0c6df46ae" kindref="member">Msb</ref><sp/>/<sp/>menc;</highlight></codeline>
<codeline lineno="134"><highlight class="normal"><sp/><sp/>*eps_rho<sp/>=<sp/>ra<sp/>/<sp/>hrho;</highlight></codeline>
<codeline lineno="135"><highlight class="normal"><sp/><sp/>*rp_over_ra<sp/>=<sp/>rhs-&gt;<ref refid="structrhs__terms_1a2da4d507d1c55b7c925c8440ad059d87" kindref="member">Rsb</ref><sp/>/<sp/>ra;</highlight></codeline>
<codeline lineno="136"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;</highlight></codeline>
<codeline lineno="137"><highlight class="normal"><sp/><sp/></highlight></codeline>
<codeline lineno="138"><highlight class="normal">}</highlight></codeline>
<codeline lineno="139"><highlight class="normal"></highlight></codeline>
<codeline lineno="140" refid="model_8c_1abca9d444b78fd82f9cfef8a367142d19" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="model_8c_1abca9d444b78fd82f9cfef8a367142d19" kindref="member">func</ref><sp/>(</highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>t,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>y[],<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>f[],<sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*params)</highlight></codeline>
<codeline lineno="141"><highlight class="normal">{</highlight></codeline>
<codeline lineno="142"><highlight class="normal"></highlight></codeline>
<codeline lineno="143"><highlight class="normal"><sp/><sp/>(void)(t);<sp/></highlight><highlight class="comment">/*<sp/>avoid<sp/>unused<sp/>parameter<sp/>warning<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="144"><highlight class="normal"></highlight></codeline>
<codeline lineno="145"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structrhs__terms" kindref="compound">rhs_terms</ref><sp/>*<sp/>rhs<sp/>=<sp/>(</highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structrhs__terms" kindref="compound">rhs_terms</ref><sp/>*)params;</highlight></codeline>
<codeline lineno="146"><highlight class="normal"></highlight></codeline>
<codeline lineno="147"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>menc,<sp/>rho,<sp/>cs,<sp/>hrho,<sp/>q,<sp/>eps_rho,<sp/>rp_over_ra;</highlight></codeline>
<codeline lineno="148"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>status1<sp/>=<sp/>gsl_spline_eval_e(<ref refid="global_8h_1abb8a871881d465e7625f07eddffa6785" kindref="member">spline_menc</ref>,<sp/>y[0],<sp/><ref refid="global_8h_1a7b76ae9f39a443e206a410c051e557fe" kindref="member">acc_menc</ref>,<sp/>&amp;menc);</highlight></codeline>
<codeline lineno="149"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>status2<sp/>=<sp/>gsl_spline_eval_e(<ref refid="global_8h_1a78d5a9eaea222c102b5f9ead2eba41ef" kindref="member">spline_rho</ref>,<sp/>y[0],<sp/><ref refid="global_8h_1acf79bf70f986b203fe7fd8eb3e91a634" kindref="member">acc_rho</ref>,<sp/>&amp;rho);</highlight></codeline>
<codeline lineno="150"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>status3<sp/>=<sp/>gsl_spline_eval_e(<ref refid="global_8h_1adebc07be0db5cfee6bf35217cc1f8936" kindref="member">spline_cs</ref>,<sp/>y[0],<sp/><ref refid="global_8h_1a8c5a521dd2cb882da9a99937f79f5837" kindref="member">acc_cs</ref>,<sp/>&amp;cs);</highlight></codeline>
<codeline lineno="151"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>status4<sp/>=<sp/>gsl_spline_eval_e(<ref refid="global_8h_1ad9933c0d0863db02128a37ab15bccd56" kindref="member">spline_hrho</ref>,<sp/>y[0],<sp/><ref refid="global_8h_1a4f47520db4595782a0ea2d8dbceb7f48" kindref="member">acc_hrho</ref>,<sp/>&amp;hrho);</highlight></codeline>
<codeline lineno="152"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/>printf(&quot;%.2e<sp/>%.2e<sp/>%.2e<sp/>%.2e<sp/>%.2e\n&quot;,<sp/>y[0],<sp/>menc,<sp/>rho,<sp/>cs,<sp/>hrho);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="153"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>(<sp/>status1<sp/>!=<sp/>GSL_SUCCESS<sp/>)<sp/>||<sp/>(<sp/>status2<sp/>!=<sp/>GSL_SUCCESS<sp/>)<sp/>||<sp/>(<sp/>status3<sp/>!=<sp/>GSL_SUCCESS<sp/>)<sp/>||<sp/>(<sp/>status4<sp/>!=<sp/>GSL_SUCCESS<sp/>)<sp/>){</highlight></codeline>
<codeline lineno="154"><highlight class="normal"><sp/><sp/><sp/><sp/>printf(</highlight><highlight class="stringliteral">&quot;Interpolation<sp/>failed<sp/>at<sp/>radius<sp/>%.10e.<sp/>Exit<sp/>codes<sp/>for<sp/>menc,<sp/>rho,<sp/>cs,<sp/>hrho<sp/>splines:<sp/>%i<sp/>%i<sp/>%i<sp/>%i\n&quot;</highlight><highlight class="normal">,<sp/>y[0],<sp/>status1,<sp/>status2,<sp/>status3,<sp/>status4);</highlight></codeline>
<codeline lineno="155"><highlight class="normal"><sp/><sp/><sp/><sp/>exit(-1);</highlight></codeline>
<codeline lineno="156"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="157"><highlight class="normal"></highlight></codeline>
<codeline lineno="158"><highlight class="normal"><sp/><sp/><ref refid="model_8c_1a7413b3adbedc8ce3474a78d49a6b9721" kindref="member">compute_flow_parameters</ref>(rhs,<sp/>y,<sp/>menc,<sp/>hrho,<sp/>&amp;q,<sp/>&amp;eps_rho,<sp/>&amp;rp_over_ra);</highlight></codeline>
<codeline lineno="159"><highlight class="normal"></highlight></codeline>
<codeline lineno="160"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>f_r<sp/>=<sp/>0.;</highlight></codeline>
<codeline lineno="161"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>f_theta<sp/>=<sp/>0.;</highlight></codeline>
<codeline lineno="162"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>v_theta<sp/>=<sp/>y[0]<sp/>*<sp/>y[3];</highlight></codeline>
<codeline lineno="163"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>mach<sp/>=<sp/>fabs(v_theta<sp/>/<sp/>cs);</highlight></codeline>
<codeline lineno="164"><highlight class="normal"></highlight></codeline>
<codeline lineno="165"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Hydrodynamical<sp/>drag</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="166"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>rhs-&gt;<ref refid="structrhs__terms_1ac13ca99dc6b23ea6aefc0b4d8c063341" kindref="member">f_hydro</ref><sp/>==<sp/>1<sp/>)<sp/>f_theta<sp/>+=<sp/><ref refid="model_8c_1af133e6d3b99c19b9b1ffba51e05adc50" kindref="member">f_hydro</ref>(rhs,<sp/>rho,<sp/>v_theta,<sp/>q,<sp/>eps_rho,<sp/>rp_over_ra);</highlight></codeline>
<codeline lineno="167"><highlight class="normal"></highlight></codeline>
<codeline lineno="168"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Gravitational<sp/>drag</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="169"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>rhs-&gt;<ref refid="structrhs__terms_1abe610e4b414ddeede219782c0248c991" kindref="member">f_grav</ref><sp/>==<sp/>1<sp/>&amp;&amp;<sp/>mach<sp/>&gt;<sp/>0.25<sp/>)<sp/>f_theta<sp/>+=<sp/><ref refid="model_8c_1a52123df6ff7716db1b9bc37a231b9705" kindref="member">f_grav</ref>(rhs,<sp/>rho,<sp/>v_theta,<sp/>q,<sp/>eps_rho,<sp/>rp_over_ra);</highlight></codeline>
<codeline lineno="170"><highlight class="normal"></highlight></codeline>
<codeline lineno="171"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Buoyancy</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="172"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>rhs-&gt;<ref refid="structrhs__terms_1a8e88fe897d46f15c82e2d9a35078d646" kindref="member">f_buoyancy</ref><sp/>==<sp/>1<sp/>)<sp/>f_r<sp/>+=<sp/>rho<sp/>*<sp/>4.<sp/>*<sp/>M_PI<sp/>*<sp/>pow(rhs-&gt;<ref refid="structrhs__terms_1a2da4d507d1c55b7c925c8440ad059d87" kindref="member">Rsb</ref>,<sp/>3.)<sp/>/<sp/>3.;</highlight></codeline>
<codeline lineno="173"><highlight class="normal"></highlight></codeline>
<codeline lineno="174"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/>printf(&quot;q<sp/>=<sp/>%.2e,<sp/>eps_rho<sp/>=<sp/>%.2e,<sp/>Rp/Ra<sp/>=<sp/>%.2e,<sp/>Cp<sp/>=<sp/>%.2e,<sp/>Cg<sp/>=<sp/>%.2e\n&quot;,<sp/>rhs-&gt;Msb<sp/>/<sp/>menc,<sp/>eps_rho,<sp/>rhs-&gt;Rsb<sp/>/<sp/>ra,<sp/>cp,<sp/>cg);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="175"><highlight class="normal"></highlight></codeline>
<codeline lineno="176"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/>y[0]<sp/>=<sp/>r,<sp/>y[1]<sp/>=<sp/>theta,<sp/>y[2]<sp/>=<sp/>vr,<sp/>y[3]<sp/>=<sp/>d(theta)/dt</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="177"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>dr/dt<sp/>=<sp/>vr</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="178"><highlight class="normal"><sp/><sp/>f[0]<sp/>=<sp/>y[2];</highlight></codeline>
<codeline lineno="179"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/>printf(&quot;f[0]<sp/>=<sp/>%.2e\n&quot;,<sp/>f[0]);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="180"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>d(theta)/dt<sp/>=<sp/>d(theta)/dt<sp/>duh</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="181"><highlight class="normal"><sp/><sp/>f[1]<sp/>=<sp/>y[3];</highlight></codeline>
<codeline lineno="182"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/>printf(&quot;f[1]<sp/>=<sp/>%.2e\n&quot;,<sp/>f[1]);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="183"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>dvr/dt<sp/>=<sp/>-<sp/>G<sp/>Menc<sp/>/<sp/>r^2<sp/>+<sp/>rotational<sp/>support</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="184"><highlight class="normal"><sp/><sp/>f[2]<sp/>=<sp/>-<sp/>rhs-&gt;<ref refid="structrhs__terms_1a58e190d6c49e164fd7a2861bb2661586" kindref="member">G</ref><sp/>*<sp/>menc<sp/>/<sp/>y[0]<sp/>/<sp/>y[0]<sp/>+<sp/>v_theta<sp/>*<sp/>v_theta<sp/>/<sp/>y[0]<sp/>+<sp/>f_r<sp/>/<sp/>rhs-&gt;<ref refid="structrhs__terms_1a23f99710c6e1d093311561f0c6df46ae" kindref="member">Msb</ref>;</highlight></codeline>
<codeline lineno="185"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/>printf(&quot;f[2]<sp/>=<sp/>%.2e\n&quot;,<sp/>f[2]);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="186"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>d2(theta)/dt2<sp/>=<sp/>coordinate<sp/>terms<sp/>+<sp/>acceleration<sp/>from<sp/>forces</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="187"><highlight class="normal"><sp/><sp/>f[3]<sp/>=<sp/>-2.<sp/>*<sp/>y[2]<sp/>*<sp/>y[3]<sp/>/<sp/>y[0]<sp/>+<sp/>f_theta<sp/>/<sp/>rhs-&gt;<ref refid="structrhs__terms_1a23f99710c6e1d093311561f0c6df46ae" kindref="member">Msb</ref><sp/>/<sp/>y[0];</highlight></codeline>
<codeline lineno="188"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/>printf(&quot;f[3]<sp/>=<sp/>%.2e\n&quot;,<sp/>f[3]);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="189"><highlight class="normal"></highlight></codeline>
<codeline lineno="190"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/>printf(&quot;<sp/>%.10e<sp/>%.10e\n&quot;,<sp/>y[0],<sp/>-<sp/>4.<sp/>*<sp/>M_PI<sp/>*<sp/>pow(rhs-&gt;G,<sp/>2.)<sp/>*<sp/>sign(v_theta)<sp/>*<sp/>cg<sp/>*<sp/>rho<sp/>*<sp/>pow(rhs-&gt;Msb,<sp/>2.)<sp/>/<sp/>fabs(v_theta<sp/>*<sp/>v_theta));</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="191"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/>double<sp/>edot<sp/>=<sp/>rhs-&gt;G<sp/>*<sp/>menc<sp/>*<sp/>y[2]<sp/>/<sp/>pow(y[0],<sp/>2.)<sp/>+<sp/>y[2]<sp/>*<sp/>(<sp/>y[0]<sp/>*<sp/>(<sp/>-<sp/>4.<sp/>*<sp/>rhs-&gt;G<sp/>*<sp/>M_PI<sp/>*<sp/>rho<sp/>+<sp/>pow(y[3],<sp/>2.)<sp/>)<sp/>+<sp/>f[2]<sp/>)<sp/>+<sp/>pow(y[0],<sp/>2.)<sp/>*<sp/>y[3]<sp/>*<sp/>f[3];</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="192"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/>edot<sp/>*=<sp/>rhs-&gt;Msb;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="193"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/>printf(&quot;<sp/>%.20e<sp/>%.20e\n&quot;,<sp/>y[0],<sp/>edot);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="194"><highlight class="normal"></highlight></codeline>
<codeline lineno="195"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>GSL_SUCCESS;</highlight></codeline>
<codeline lineno="196"><highlight class="normal"></highlight></codeline>
<codeline lineno="197"><highlight class="normal">}</highlight></codeline>
<codeline lineno="198"><highlight class="normal"></highlight></codeline>
<codeline lineno="199" refid="model_8c_1a5820dd0dc3a4b0513ac690f4408dc410" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="model_8c_1a5820dd0dc3a4b0513ac690f4408dc410" kindref="member">init_model_params</ref>(</highlight><highlight class="keyword">struct</highlight><highlight class="normal"><sp/><ref refid="structparameters" kindref="compound">parameters</ref><sp/>P,<sp/></highlight><highlight class="keyword">struct</highlight><highlight class="normal"><sp/><ref refid="structstar" kindref="compound">star</ref><sp/>S,<sp/></highlight><highlight class="keyword">struct</highlight><highlight class="normal"><sp/><ref refid="structunits" kindref="compound">units</ref><sp/>U,<sp/></highlight><highlight class="keyword">struct</highlight><highlight class="normal"><sp/><ref refid="structrhs__terms" kindref="compound">rhs_terms</ref><sp/>*rhs){</highlight></codeline>
<codeline lineno="200"><highlight class="normal"></highlight></codeline>
<codeline lineno="201"><highlight class="normal"><sp/><sp/>rhs-&gt;<ref refid="structrhs__terms_1ab2616c315e3e04aeeb268ad0a5cd2723" kindref="member">sigma_hydro</ref><sp/>=<sp/>M_PI<sp/>*<sp/>P.<ref refid="structparameters_1a44dd01bc440a7226465b0e38310929b1" kindref="member">Rsb</ref><sp/>*<sp/>P.<ref refid="structparameters_1a44dd01bc440a7226465b0e38310929b1" kindref="member">Rsb</ref>;</highlight></codeline>
<codeline lineno="202"><highlight class="normal"><sp/><sp/>rhs-&gt;<ref refid="structrhs__terms_1a23f99710c6e1d093311561f0c6df46ae" kindref="member">Msb</ref><sp/>=<sp/>P.<ref refid="structparameters_1ab5115d22be6204fdc5bbf6445269efa0" kindref="member">Msb</ref>;</highlight></codeline>
<codeline lineno="203"><highlight class="normal"><sp/><sp/>rhs-&gt;<ref refid="structrhs__terms_1a2da4d507d1c55b7c925c8440ad059d87" kindref="member">Rsb</ref><sp/>=<sp/>P.<ref refid="structparameters_1a44dd01bc440a7226465b0e38310929b1" kindref="member">Rsb</ref>;</highlight></codeline>
<codeline lineno="204"><highlight class="normal"><sp/><sp/>rhs-&gt;<ref refid="structrhs__terms_1a58e190d6c49e164fd7a2861bb2661586" kindref="member">G</ref><sp/>=<sp/>U.<ref refid="structunits_1ab46825a17a984286d00a3a09bdf28571" kindref="member">G</ref>;</highlight></codeline>
<codeline lineno="205"><highlight class="normal"><sp/><sp/>rhs-&gt;<ref refid="structrhs__terms_1ac13ca99dc6b23ea6aefc0b4d8c063341" kindref="member">f_hydro</ref><sp/>=<sp/>P.<ref refid="structparameters_1a6960e6f48d147c12441609628d186b35" kindref="member">f_hydro</ref>;</highlight></codeline>
<codeline lineno="206"><highlight class="normal"><sp/><sp/>rhs-&gt;<ref refid="structrhs__terms_1abe610e4b414ddeede219782c0248c991" kindref="member">f_grav</ref><sp/>=<sp/>P.<ref refid="structparameters_1a44b8f833c7ff07dc990a137b49d306f3" kindref="member">f_grav</ref>;</highlight></codeline>
<codeline lineno="207"><highlight class="normal"><sp/><sp/>rhs-&gt;<ref refid="structrhs__terms_1a8e88fe897d46f15c82e2d9a35078d646" kindref="member">f_buoyancy</ref><sp/>=<sp/>P.<ref refid="structparameters_1a65676f4e46da862a87074caa262f7352" kindref="member">f_buoyancy</ref>;</highlight></codeline>
<codeline lineno="208"><highlight class="normal"></highlight></codeline>
<codeline lineno="209"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Numerical<sp/>drag<sp/>coefficients<sp/>stuff</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="210"><highlight class="normal"><sp/><sp/>rhs-&gt;<ref refid="structrhs__terms_1ac364a399b048a1b67d986844d0fc7c99" kindref="member">use_drag_coefficients</ref><sp/>=<sp/>P.<ref refid="structparameters_1ab8ff76e9250a51d11724566a9fe840ca" kindref="member">use_drag_coefficients</ref>;</highlight></codeline>
<codeline lineno="211"><highlight class="normal"></highlight></codeline>
<codeline lineno="212"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>P.<ref refid="structparameters_1ab8ff76e9250a51d11724566a9fe840ca" kindref="member">use_drag_coefficients</ref><sp/>==<sp/>1<sp/>){</highlight></codeline>
<codeline lineno="213"><highlight class="normal"></highlight></codeline>
<codeline lineno="214"><highlight class="normal"><sp/><sp/>hid_t<sp/>file_id,<sp/>dataset_id;</highlight></codeline>
<codeline lineno="215"><highlight class="normal"></highlight></codeline>
<codeline lineno="216"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Open<sp/>file</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="217"><highlight class="normal"><sp/><sp/>file_id<sp/>=<sp/>H5Fopen(P.<ref refid="structparameters_1a222e7500d94731b8efdae777c71ca8d9" kindref="member">drag_data_path</ref>,<sp/>H5F_ACC_RDONLY,<sp/>H5P_DEFAULT);</highlight></codeline>
<codeline lineno="218"><highlight class="normal"></highlight></codeline>
<codeline lineno="219"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Get<sp/>number<sp/>of<sp/>cells</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="220"><highlight class="normal"><sp/><sp/>dataset_id<sp/>=<sp/>H5Dopen2(file_id,<sp/></highlight><highlight class="stringliteral">&quot;/npoints&quot;</highlight><highlight class="normal">,<sp/>H5P_DEFAULT);</highlight></codeline>
<codeline lineno="221"><highlight class="normal"><sp/><sp/><ref refid="global_8h_1ad2753c8a41f8a7a0f8b707fe3316f2dd" kindref="member">h5safecall</ref>(H5Dread(dataset_id,<sp/>H5T_NATIVE_INT,<sp/>H5S_ALL,<sp/>H5S_ALL,<sp/>H5P_DEFAULT,<sp/>&amp;rhs-&gt;<ref refid="structrhs__terms_1a303e005485ab20b9778d064fd43ded3f" kindref="member">drag_data_dims</ref>));</highlight></codeline>
<codeline lineno="222"><highlight class="normal"><sp/><sp/><ref refid="global_8h_1ad2753c8a41f8a7a0f8b707fe3316f2dd" kindref="member">h5safecall</ref>(H5Dclose(dataset_id));</highlight></codeline>
<codeline lineno="223"><highlight class="normal"></highlight></codeline>
<codeline lineno="224"><highlight class="normal"><sp/><sp/>rhs-&gt;<ref refid="structrhs__terms_1a04fab25e61816a44ef263ff83e046519" kindref="member">log_q_vals</ref><sp/>=<sp/>(</highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>*)<sp/>malloc(rhs-&gt;<ref refid="structrhs__terms_1a303e005485ab20b9778d064fd43ded3f" kindref="member">drag_data_dims</ref>[0]<sp/>*<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(</highlight><highlight class="keywordtype">double</highlight><highlight class="normal">));</highlight></codeline>
<codeline lineno="225"><highlight class="normal"><sp/><sp/>rhs-&gt;<ref refid="structrhs__terms_1a8ad51f73f9fc24cb4b878d4ac5361cc7" kindref="member">log_eps_rho_vals</ref><sp/>=<sp/>(</highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>*)<sp/>malloc(rhs-&gt;<ref refid="structrhs__terms_1a303e005485ab20b9778d064fd43ded3f" kindref="member">drag_data_dims</ref>[1]<sp/>*<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(</highlight><highlight class="keywordtype">double</highlight><highlight class="normal">));</highlight></codeline>
<codeline lineno="226"><highlight class="normal"><sp/><sp/>rhs-&gt;<ref refid="structrhs__terms_1a77180908c43f26b69a47d40d2c081a92" kindref="member">log_rp_over_ra_vals</ref><sp/>=<sp/>(</highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>*)<sp/>malloc(rhs-&gt;<ref refid="structrhs__terms_1a303e005485ab20b9778d064fd43ded3f" kindref="member">drag_data_dims</ref>[2]<sp/>*<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(</highlight><highlight class="keywordtype">double</highlight><highlight class="normal">));</highlight></codeline>
<codeline lineno="227"><highlight class="normal"></highlight></codeline>
<codeline lineno="228"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>log10(q)<sp/>values</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="229"><highlight class="normal"><sp/><sp/>dataset_id<sp/>=<sp/>H5Dopen2(file_id,<sp/></highlight><highlight class="stringliteral">&quot;/log10_qs&quot;</highlight><highlight class="normal">,<sp/>H5P_DEFAULT);</highlight></codeline>
<codeline lineno="230"><highlight class="normal"><sp/><sp/><ref refid="global_8h_1ad2753c8a41f8a7a0f8b707fe3316f2dd" kindref="member">h5safecall</ref>(H5Dread(dataset_id,<sp/>H5T_NATIVE_DOUBLE,<sp/>H5S_ALL,<sp/>H5S_ALL,<sp/>H5P_DEFAULT,<sp/>rhs-&gt;<ref refid="structrhs__terms_1a04fab25e61816a44ef263ff83e046519" kindref="member">log_q_vals</ref>));</highlight></codeline>
<codeline lineno="231"><highlight class="normal"><sp/><sp/><ref refid="global_8h_1ad2753c8a41f8a7a0f8b707fe3316f2dd" kindref="member">h5safecall</ref>(H5Dclose(dataset_id));</highlight></codeline>
<codeline lineno="232"><highlight class="normal"></highlight></codeline>
<codeline lineno="233"><highlight class="normal"></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="234"><highlight class="comment"><sp/><sp/>printf(&quot;q<sp/>values\n&quot;);</highlight></codeline>
<codeline lineno="235"><highlight class="comment"><sp/><sp/>for<sp/>(<sp/>int<sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>rhs-&gt;drag_data_dims[0];<sp/>i++<sp/>)<sp/>printf(&quot;%.2e\n&quot;,<sp/>pow(10,<sp/>rhs-&gt;log_q_vals[i]));</highlight></codeline>
<codeline lineno="236"><highlight class="comment">*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="237"><highlight class="normal"></highlight></codeline>
<codeline lineno="238"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>log10(eps_rho)<sp/>values</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="239"><highlight class="normal"><sp/><sp/>dataset_id<sp/>=<sp/>H5Dopen2(file_id,<sp/></highlight><highlight class="stringliteral">&quot;/log10_eps_rhos&quot;</highlight><highlight class="normal">,<sp/>H5P_DEFAULT);</highlight></codeline>
<codeline lineno="240"><highlight class="normal"><sp/><sp/><ref refid="global_8h_1ad2753c8a41f8a7a0f8b707fe3316f2dd" kindref="member">h5safecall</ref>(H5Dread(dataset_id,<sp/>H5T_NATIVE_DOUBLE,<sp/>H5S_ALL,<sp/>H5S_ALL,<sp/>H5P_DEFAULT,<sp/>rhs-&gt;<ref refid="structrhs__terms_1a8ad51f73f9fc24cb4b878d4ac5361cc7" kindref="member">log_eps_rho_vals</ref>));</highlight></codeline>
<codeline lineno="241"><highlight class="normal"><sp/><sp/><ref refid="global_8h_1ad2753c8a41f8a7a0f8b707fe3316f2dd" kindref="member">h5safecall</ref>(H5Dclose(dataset_id));</highlight></codeline>
<codeline lineno="242"><highlight class="normal"></highlight></codeline>
<codeline lineno="243"><highlight class="normal"></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="244"><highlight class="comment"><sp/><sp/>printf(&quot;eps_rho<sp/>values\n&quot;);</highlight></codeline>
<codeline lineno="245"><highlight class="comment"><sp/><sp/>for<sp/>(<sp/>int<sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>rhs-&gt;drag_data_dims[1];<sp/>i++<sp/>)<sp/>printf(&quot;%.2e\n&quot;,<sp/>pow(10,<sp/>rhs-&gt;log_eps_rho_vals[i]));</highlight></codeline>
<codeline lineno="246"><highlight class="comment">*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="247"><highlight class="normal"></highlight></codeline>
<codeline lineno="248"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>log10(rp_over_ra)<sp/>values</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="249"><highlight class="normal"><sp/><sp/>dataset_id<sp/>=<sp/>H5Dopen2(file_id,<sp/></highlight><highlight class="stringliteral">&quot;/log10_rp_over_ras&quot;</highlight><highlight class="normal">,<sp/>H5P_DEFAULT);</highlight></codeline>
<codeline lineno="250"><highlight class="normal"><sp/><sp/><ref refid="global_8h_1ad2753c8a41f8a7a0f8b707fe3316f2dd" kindref="member">h5safecall</ref>(H5Dread(dataset_id,<sp/>H5T_NATIVE_DOUBLE,<sp/>H5S_ALL,<sp/>H5S_ALL,<sp/>H5P_DEFAULT,<sp/>rhs-&gt;<ref refid="structrhs__terms_1a77180908c43f26b69a47d40d2c081a92" kindref="member">log_rp_over_ra_vals</ref>));</highlight></codeline>
<codeline lineno="251"><highlight class="normal"><sp/><sp/><ref refid="global_8h_1ad2753c8a41f8a7a0f8b707fe3316f2dd" kindref="member">h5safecall</ref>(H5Dclose(dataset_id));</highlight></codeline>
<codeline lineno="252"><highlight class="normal"></highlight></codeline>
<codeline lineno="253"><highlight class="normal"></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="254"><highlight class="comment"><sp/><sp/>printf(&quot;rp_over_ra<sp/>values\n&quot;);</highlight></codeline>
<codeline lineno="255"><highlight class="comment"><sp/><sp/>for<sp/>(<sp/>int<sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>rhs-&gt;drag_data_dims[2];<sp/>i++<sp/>)<sp/>printf(&quot;%.2e\n&quot;,<sp/>pow(10,<sp/>rhs-&gt;log_rp_over_ra_vals[i]));</highlight></codeline>
<codeline lineno="256"><highlight class="comment">*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="257"><highlight class="normal"></highlight></codeline>
<codeline lineno="258"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Load<sp/>gravitational<sp/>drag</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="259"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/>printf(&quot;Allocating<sp/>gravitational<sp/>drag\n&quot;);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="260"><highlight class="normal"><sp/><sp/>rhs-&gt;<ref refid="structrhs__terms_1a63081a901688a91090165ce0f54aa353" kindref="member">cg_data</ref><sp/>=<sp/>(</highlight><highlight class="keywordtype">double</highlight><highlight class="normal">***)malloc(rhs-&gt;<ref refid="structrhs__terms_1a303e005485ab20b9778d064fd43ded3f" kindref="member">drag_data_dims</ref>[0]<sp/>*<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(</highlight><highlight class="keywordtype">double</highlight><highlight class="normal">**));</highlight></codeline>
<codeline lineno="261"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>rhs-&gt;<ref refid="structrhs__terms_1a303e005485ab20b9778d064fd43ded3f" kindref="member">drag_data_dims</ref>[0];<sp/>i++<sp/>){</highlight></codeline>
<codeline lineno="262"><highlight class="normal"><sp/><sp/><sp/><sp/>rhs-&gt;<ref refid="structrhs__terms_1a63081a901688a91090165ce0f54aa353" kindref="member">cg_data</ref>[i]<sp/>=<sp/>(</highlight><highlight class="keywordtype">double</highlight><highlight class="normal">**)malloc(rhs-&gt;<ref refid="structrhs__terms_1a303e005485ab20b9778d064fd43ded3f" kindref="member">drag_data_dims</ref>[1]<sp/>*<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(</highlight><highlight class="keywordtype">double</highlight><highlight class="normal">*));</highlight></codeline>
<codeline lineno="263"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>j<sp/>=<sp/>0;<sp/>j<sp/>&lt;<sp/>rhs-&gt;<ref refid="structrhs__terms_1a303e005485ab20b9778d064fd43ded3f" kindref="member">drag_data_dims</ref>[1];<sp/>j++<sp/>){</highlight></codeline>
<codeline lineno="264"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>rhs-&gt;<ref refid="structrhs__terms_1a63081a901688a91090165ce0f54aa353" kindref="member">cg_data</ref>[i][j]<sp/>=<sp/>(</highlight><highlight class="keywordtype">double</highlight><highlight class="normal">*)malloc(rhs-&gt;<ref refid="structrhs__terms_1a303e005485ab20b9778d064fd43ded3f" kindref="member">drag_data_dims</ref>[2]<sp/>*<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(</highlight><highlight class="keywordtype">double</highlight><highlight class="normal">));</highlight></codeline>
<codeline lineno="265"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="266"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="267"><highlight class="normal"></highlight></codeline>
<codeline lineno="268"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/>for<sp/>(<sp/>int<sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>3;<sp/>i++<sp/>)<sp/>printf(&quot;%i\n&quot;,<sp/>rhs-&gt;drag_data_dims[i]);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="269"><highlight class="normal"></highlight></codeline>
<codeline lineno="270"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>drag_data_temp[rhs-&gt;<ref refid="structrhs__terms_1a303e005485ab20b9778d064fd43ded3f" kindref="member">drag_data_dims</ref>[0]][rhs-&gt;<ref refid="structrhs__terms_1a303e005485ab20b9778d064fd43ded3f" kindref="member">drag_data_dims</ref>[1]][rhs-&gt;<ref refid="structrhs__terms_1a303e005485ab20b9778d064fd43ded3f" kindref="member">drag_data_dims</ref>[2]];</highlight></codeline>
<codeline lineno="271"><highlight class="normal"></highlight></codeline>
<codeline lineno="272"><highlight class="normal"><sp/><sp/>dataset_id<sp/>=<sp/>H5Dopen2(file_id,<sp/></highlight><highlight class="stringliteral">&quot;/cg&quot;</highlight><highlight class="normal">,<sp/>H5P_DEFAULT);</highlight></codeline>
<codeline lineno="273"><highlight class="normal"><sp/><sp/><ref refid="global_8h_1ad2753c8a41f8a7a0f8b707fe3316f2dd" kindref="member">h5safecall</ref>(H5Dread(dataset_id,<sp/>H5T_NATIVE_DOUBLE,<sp/>H5S_ALL,<sp/>H5S_ALL,<sp/>H5P_DEFAULT,<sp/>&amp;drag_data_temp));</highlight></codeline>
<codeline lineno="274"><highlight class="normal"><sp/><sp/><ref refid="global_8h_1ad2753c8a41f8a7a0f8b707fe3316f2dd" kindref="member">h5safecall</ref>(H5Dclose(dataset_id));</highlight></codeline>
<codeline lineno="275"><highlight class="normal"></highlight></codeline>
<codeline lineno="276"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>rhs-&gt;<ref refid="structrhs__terms_1a303e005485ab20b9778d064fd43ded3f" kindref="member">drag_data_dims</ref>[0];<sp/>i++<sp/>){</highlight></codeline>
<codeline lineno="277"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>j<sp/>=<sp/>0;<sp/>j<sp/>&lt;<sp/>rhs-&gt;<ref refid="structrhs__terms_1a303e005485ab20b9778d064fd43ded3f" kindref="member">drag_data_dims</ref>[1];<sp/>j++<sp/>){</highlight></codeline>
<codeline lineno="278"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>k<sp/>=<sp/>0;<sp/>k<sp/>&lt;<sp/>rhs-&gt;<ref refid="structrhs__terms_1a303e005485ab20b9778d064fd43ded3f" kindref="member">drag_data_dims</ref>[2];<sp/>k++<sp/>){</highlight></codeline>
<codeline lineno="279"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rhs-&gt;<ref refid="structrhs__terms_1a63081a901688a91090165ce0f54aa353" kindref="member">cg_data</ref>[i][j][k]<sp/>=<sp/>drag_data_temp[i][j][k];</highlight></codeline>
<codeline lineno="280"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>printf(&quot;%.2e<sp/>%.2e<sp/>%.2e<sp/>%.2e\n&quot;,<sp/>pow(10,rhs-&gt;log_q_vals[i]),<sp/>pow(10,rhs-&gt;log_eps_rho_vals[j]),<sp/>pow(10,rhs-&gt;log_rp_over_ra_vals[k]),<sp/>rhs-&gt;cg_data[i][j][k]);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="281"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="282"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="283"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="284"><highlight class="normal"></highlight></codeline>
<codeline lineno="285"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/>for<sp/>(<sp/>int<sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>3;<sp/>i++<sp/>)<sp/>printf(&quot;%i\n&quot;,<sp/>rhs-&gt;drag_data_dims[i]);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="286"><highlight class="normal"></highlight></codeline>
<codeline lineno="287"><highlight class="normal"></highlight></codeline>
<codeline lineno="288"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/>printf(&quot;Allocating<sp/>ram<sp/>pressure<sp/>drag\n&quot;);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="289"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Load<sp/>ram<sp/>pressure<sp/>drag</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="290"><highlight class="normal"><sp/><sp/>rhs-&gt;<ref refid="structrhs__terms_1aebefffdf507433a4e958bf302c49df65" kindref="member">cp_data</ref><sp/>=<sp/>(</highlight><highlight class="keywordtype">double</highlight><highlight class="normal">***)malloc(rhs-&gt;<ref refid="structrhs__terms_1a303e005485ab20b9778d064fd43ded3f" kindref="member">drag_data_dims</ref>[0]<sp/>*<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(</highlight><highlight class="keywordtype">double</highlight><highlight class="normal">**));</highlight></codeline>
<codeline lineno="291"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>rhs-&gt;<ref refid="structrhs__terms_1a303e005485ab20b9778d064fd43ded3f" kindref="member">drag_data_dims</ref>[0];<sp/>i++<sp/>){</highlight></codeline>
<codeline lineno="292"><highlight class="normal"><sp/><sp/><sp/><sp/>rhs-&gt;<ref refid="structrhs__terms_1aebefffdf507433a4e958bf302c49df65" kindref="member">cp_data</ref>[i]<sp/>=<sp/>(</highlight><highlight class="keywordtype">double</highlight><highlight class="normal">**)malloc(rhs-&gt;<ref refid="structrhs__terms_1a303e005485ab20b9778d064fd43ded3f" kindref="member">drag_data_dims</ref>[1]<sp/>*<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(</highlight><highlight class="keywordtype">double</highlight><highlight class="normal">*));</highlight></codeline>
<codeline lineno="293"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>j<sp/>=<sp/>0;<sp/>j<sp/>&lt;<sp/>rhs-&gt;<ref refid="structrhs__terms_1a303e005485ab20b9778d064fd43ded3f" kindref="member">drag_data_dims</ref>[1];<sp/>j++<sp/>){</highlight></codeline>
<codeline lineno="294"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>rhs-&gt;<ref refid="structrhs__terms_1aebefffdf507433a4e958bf302c49df65" kindref="member">cp_data</ref>[i][j]<sp/>=<sp/>(</highlight><highlight class="keywordtype">double</highlight><highlight class="normal">*)malloc(rhs-&gt;<ref refid="structrhs__terms_1a303e005485ab20b9778d064fd43ded3f" kindref="member">drag_data_dims</ref>[2]<sp/>*<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(</highlight><highlight class="keywordtype">double</highlight><highlight class="normal">));</highlight></codeline>
<codeline lineno="295"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="296"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="297"><highlight class="normal"></highlight></codeline>
<codeline lineno="298"><highlight class="normal"><sp/><sp/>dataset_id<sp/>=<sp/>H5Dopen2(file_id,<sp/></highlight><highlight class="stringliteral">&quot;/cp&quot;</highlight><highlight class="normal">,<sp/>H5P_DEFAULT);</highlight></codeline>
<codeline lineno="299"><highlight class="normal"><sp/><sp/><ref refid="global_8h_1ad2753c8a41f8a7a0f8b707fe3316f2dd" kindref="member">h5safecall</ref>(H5Dread(dataset_id,<sp/>H5T_NATIVE_DOUBLE,<sp/>H5S_ALL,<sp/>H5S_ALL,<sp/>H5P_DEFAULT,<sp/>drag_data_temp));</highlight></codeline>
<codeline lineno="300"><highlight class="normal"><sp/><sp/><ref refid="global_8h_1ad2753c8a41f8a7a0f8b707fe3316f2dd" kindref="member">h5safecall</ref>(H5Dclose(dataset_id));</highlight></codeline>
<codeline lineno="301"><highlight class="normal"></highlight></codeline>
<codeline lineno="302"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>rhs-&gt;<ref refid="structrhs__terms_1a303e005485ab20b9778d064fd43ded3f" kindref="member">drag_data_dims</ref>[0];<sp/>i++<sp/>){</highlight></codeline>
<codeline lineno="303"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>j<sp/>=<sp/>0;<sp/>j<sp/>&lt;<sp/>rhs-&gt;<ref refid="structrhs__terms_1a303e005485ab20b9778d064fd43ded3f" kindref="member">drag_data_dims</ref>[1];<sp/>j++<sp/>){</highlight></codeline>
<codeline lineno="304"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>k<sp/>=<sp/>0;<sp/>k<sp/>&lt;<sp/>rhs-&gt;<ref refid="structrhs__terms_1a303e005485ab20b9778d064fd43ded3f" kindref="member">drag_data_dims</ref>[2];<sp/>k++<sp/>){</highlight></codeline>
<codeline lineno="305"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rhs-&gt;<ref refid="structrhs__terms_1aebefffdf507433a4e958bf302c49df65" kindref="member">cp_data</ref>[i][j][k]<sp/>=<sp/>drag_data_temp[i][j][k];</highlight></codeline>
<codeline lineno="306"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="307"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="308"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="309"><highlight class="normal"></highlight></codeline>
<codeline lineno="310"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Close<sp/>the<sp/>file</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="311"><highlight class="normal"><sp/><sp/><ref refid="global_8h_1ad2753c8a41f8a7a0f8b707fe3316f2dd" kindref="member">h5safecall</ref>(H5Fclose(file_id));</highlight></codeline>
<codeline lineno="312"><highlight class="normal"></highlight></codeline>
<codeline lineno="313"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="314"><highlight class="normal"></highlight></codeline>
<codeline lineno="315"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;</highlight></codeline>
<codeline lineno="316"><highlight class="normal"><sp/><sp/></highlight></codeline>
<codeline lineno="317"><highlight class="normal">}</highlight></codeline>
    </programlisting>
    <location file="/home/ryarza/Downloads/research/planets-ce/code/engulfment-integrator/src/model.c"/>
  </compounddef>
</doxygen>
